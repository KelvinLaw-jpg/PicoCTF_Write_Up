# Scavenger Hunt

```
Level: Easy
Tags: picoCTF 2021, Web Exploitation
Author: MADSTACKS

Description:
There is some interesting information hidden around this site http://mercury.picoctf.net:39491/. 
Can you find it?

Hints:
1. You should have enough hints to find the files, don't run a brute forcer.
```
Challenge link: [https://play.picoctf.org/practice/challenge/161](https://play.picoctf.org/practice/challenge/161)

## Solution

So, as usual lets press F12 and see whatsup.

```html
<!doctype html>
<html>
  <head>
    <title>Scavenger Hunt</title>
    <link href="https://fonts.googleapis.com/css?family=Open+Sans|Roboto" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="mycss.css">
    <script type="application/javascript" src="myjs.js"></script>
  </head>

  <body>
    <div class="container">
      <header>
		<h1>Just some boring HTML</h1>
      </header>

      <button class="tablink" onclick="openTab('tabintro', this, '#222')" id="defaultOpen">How</button>
      <button class="tablink" onclick="openTab('tababout', this, '#222')">What</button>

      <div id="tabintro" class="tabcontent">
		<h3>How</h3>
		<p>How do you like my website?</p>
      </div>

      <div id="tababout" class="tabcontent">
		<h3>What</h3>
		<p>I used these to make this site: <br/>
		  HTML <br/>
		  CSS <br/>
		  JS (JavaScript)
		</p>
	<!-- Here's the first part of the flag: picoCTF{t -->
      </div>

    </div>

  </body>
</html>
```

The bottom of the html script shows the first part of the flag. Above it the designer also hinted he/she used CSS and JS to write this site so lets check them out

---

```css
div.container {
    width: 100%;
}

header {
    background-color: black;
    padding: 1em;
    color: white;
    clear: left;
    text-align: center;
}

body {
    font-family: Roboto;
}

h1 {
    color: white;
}

p {
    font-family: "Open Sans";
}

.tablink {
    background-color: #555;
    color: white;
    float: left;
    border: none;
    outline: none;
    cursor: pointer;
    padding: 14px 16px;
    font-size: 17px;
    width: 50%;
}

.tablink:hover {
    background-color: #777;
}

.tabcontent {
    color: #111;
    display: none;
    padding: 50px;
    text-align: center;
}

#tabintro { background-color: #ccc; }
#tababout { background-color: #ccc; }

/* CSS makes the page look nice, and yes, it also has part of the flag. Here's part 2: h4ts_4_l0 */
```

At the bottom of the CSS-code there is the second part of the flag

Next, lets have a look at the `myjs.js` file.  

---

```javascript
function openTab(tabName,elmnt,color) {
    var i, tabcontent, tablinks;
    tabcontent = document.getElementsByClassName("tabcontent");
    for (i = 0; i < tabcontent.length; i++) {
	tabcontent[i].style.display = "none";
    }
    tablinks = document.getElementsByClassName("tablink");
    for (i = 0; i < tablinks.length; i++) {
	tablinks[i].style.backgroundColor = "";
    }
    document.getElementById(tabName).style.display = "block";
    if(elmnt.style != null) {
	elmnt.style.backgroundColor = color;
    }
}

window.onload = function() {
    openTab('tabintro', this, '#222');
}

/* How can I keep Google from indexing my website? */
```

Interestingly, instead of a flag, the designer wants us to learn about indexing.
Here is a great [video](https://www.youtube.com/watch?v=0pxQxX1OfIw) on indexing and also talks about crawling.
Also another one [here](https://www.youtube.com/watch?v=xqvnBxu7960&t=178s)

After the above videos, we know that crawling and indexing is controled by robots, here is a good post on [robots.txt](https://www.linkbuildinghq.com/beginners-guide-robots-txt/) 

---

Go to `http://mercury.picoctf.net:39491/robots.txt`
```
User-agent: *
Disallow: /index.html
# Part 3: t_0f_pl4c
# I think this is an apache server... can you Access the next flag?
```

we see the third flag and a new hint. So....wtf is apache server?

---
## (*A FEW HOURS LATER...*)

you will understand that apache server is a software server. Here is a brief [video](https://www.youtube.com/watch?v=kaaenHXO4t4) about it.
An actual practice [video](https://www.youtube.com/watch?v=1CDxpAzvLKY) on how apache is used 
Since the word Access is in capital 'A'. The designer clearly give us a hint on the word `access`

## (*MANY HOURS LATER...*)

you will find there are multiple ways to enable/disable, control the functions of an apache server.

| File/Directory  | Purpose |
| ------------- | ------------- |
| httpd.conf / apache2.conf  | Main configuration file for the server.  |
| sites-available/ & sites-enabled/  | Virtual host configurations, enabling multiple websites.  |
| .htaccess  | Directory-level configuration, often used for rewrites and access controls.  |
| conf.d/  | Additional configuration files (e.g., SSL, proxy settings).  |
| envvars  | Environment variables for Apache processes.  |
| mods-available/ & mods-enabled/  | Manages the loading of Apache modules.  |
| ssl.conf  | Handles SSL/TLS configurations for HTTPS.  |

Now, I have 0 understanding of what any of those are. But apparently we can just try them out each one by each one.
If you are not as dumb as me. You will try `.htaccess first`, since the hint is `Access `.
After brute forcing the above options , you will get the flag @ `http://mercury.picoctf.net:39491/.htaccess`

Here is some good stuff on [.htaccess](https://en.wikipedia.org/wiki/.htaccess) and also this [video](https://www.youtube.com/watch?v=vVtnHxqM6jA).


```
# Part 4: <REDACTED>
# I love making websites on my Mac, I can Store a lot of information there.
```
## (*At this point...... life is quite depressing because there is part 5 of the flag*)

And the hint is basically useless...

---

Mac and capital 'S'tore is the next hint.  
Let's check for the [.DS_Store](https://en.wikipedia.org/wiki/.DS_Store) file.

Browse to `http://mercury.picoctf.net:39491/.DS_Store` and you get
```
Congrats! You completed the scavenger hunt. Part 5: <REDACTED>}
```
